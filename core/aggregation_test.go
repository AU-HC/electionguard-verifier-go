package core

import (
	"electionguard-verifier-go/schema"
	"testing"
)

func TestMulP(t *testing.T) {
	one := schema.MakeBigIntFromString("E8694C850FC5D46BC780A1A2345913E159C1662DA5AF42CEDE569A12FFAA28A54EF08CE8D22E4B5E31A3FB6ADFEA922F70C53EA7AB23C83A44EE3891FCEE6A67C257DA73B74B73ED63A1C2DABCE876AF0FC45073B96F16666EEDAFF04C7C52ECE6A90EEFE8C65F2B5C30D052B891F7BECAC707B224430B84D943883198CACDD3E9B1EF893B5D161C15517CE051141ED3F128533922589862FE802B494BEE23767CDFC338871A0B21B787674F7A6FD4FAF5BF18BB70CD431FBA273D445163908CE5D78960224FCA92D83DB6B54915E847B785E1089AC55BCB2719551D48E148951A9DB0BB40B3B8E6CD01EEB4A3A8EA11FD4C957E9993746C1016EB7101C58ECEFB82E66D694CF4EDD6C245608E017159A41004347B155DC266E88558C7F204059E67A2DC20FC2562753D325C7523997FDDC36D8A255ADC5A2FC3209D1536559870604BA7317B7B0B64E18842CCB648864663C7CB95751CDFFB64DD53EBCFF4EB97AE4FF865D0FCEAF2B10F9C31D26DD1415ABE9DD388BC0E1D3D5B8D80D8A6EBC74C769C952077C1DD9DC253CA4890F375485D85DB5DE4E1CCD2136A9A9EEFD51767FD3A0D4F243CBF30AE9B0803F5F3CE147424937B7AA4C1BB466CCF7145A1AA4C5D731A8A5FEC9D0B094829D74BAC053BB52FD49EFCEF5ECF1ACE97974AE5D226A9C8FC624EC246DC40331AE4D21BDCD9DB375B7C2BE06E6D2695FB6351FF", 16)
	two := schema.MakeBigIntFromString("E25B300406650E52ECC79B86FD3200A4F371B226B06781E144C313A04C08D146F3A825C0E5A7FF4C2FBEF2CD04216227F5B026D20A433CC9BC4003F640FD2BCDA7ED9ACCE54A15FB245D9E12EA94AE903BE9B9241C1A7CEC823B4B79DE4D0AE72CA0387F09B08C0D67A7BE447E758A1236097A26A84058694A4286DAB8363D6064CBF41B1D47F81FBD9096FB6501B1D891E7D847496B03D76E7D2B01FD4E685C8881B8608B896CE51B5E19F6A4002A35A677715CAF979D49C7AC06E51004A2D9BD24CD9601A2823AB2DB0A6E1DF8F83F3DAC849DD2F9A9EE982413095E7FC2F0CDA16B02A611250B89170862857470A679C392C2A39AAC7F0899516E6186B84D81C3E32E0CDD27BBBC919133FB7FFDA57F843B59DC343E4D3BA169CEC49B45963A45FEB337CA42528F175B5B341A3B7E7D4F05711FA481BAB34D2BF2F3555082EED6E0AEE7411497F9D90860EAA13FD15FB5FBC5B76E8B4C1056BC0FF29F4E28BA3D6FE08757BA194D3C7EFA47EA73268E94456BCB553E86157B0CC314584176E972E173BCBCA6F4D6D4D12DB1D38065F504A6EEBEF737271AE7C328B6B1A9DCA09C5C34578DC7530C2FA3AB48F698AAD801667BE4DA1079A41D0EAF8484735D14CEF5926C34991878EB7532CB5F0FA34F9BD9444ED379D08B82216DACA8565D1E0C71EFE84B4462DC9AFB94420F035B0262AD638B5E3FC30D26A5B9F6C38DE6", 16)
	three := schema.MakeBigIntFromString("25A11D5838620FC89E789B436D3682DEC740F1F8328E4948C2CFDD8D9FC3BAEA9298B7E430A3C7C67CE1096E26623D6ED1B65EEE31ED0314F852461F2054ABF1EE0EC31E6F1295CD222EE0BD44EA56B4E89B6C2BBF14EE5FFCA44C179926133ED6F9C67B57CAF3420CDC5D51C724EB2FFBAB658F37CFA470C9DD9E438411685A9BCDDFCCB03D5146227C10618DDDF791747E320990433CBED903BC24C8A089605EC46A3EA5DF9D8D398634CD0387701F1308C4B191798D804E95C652A9CE53D22110E2A527BA742A12954653D204FB095BFC806BB251855ECF7B0365C190EB34F801CA6A6DDB2D9C28133E47485357328696CDA2EDB519A873EDB57B492E14DA17025E4AB935EA6822F986F1893F4F38ACFF2EA6A052D71BD010FFB136059F1E6E0B9E7B43E6B6E612B94CE20E79A473D2B3E2DE463A5DBA773C1C8BFD1925E1064F096B36E5B8ABA63E45A6CA62309DF5BA3024C9699158995B523F4E07383E84E2EAE1CA8A89D2AE80AE7C14A0139840C06DEE5B0F5CE1F621C29CD07A56F6D55B9D4397F383379000CD173A9C5BCEBEA734261A44F955923623DE988A473CCFDCAD96D2C482109CA2223431AD330C8CB6E99710072D998D6F974B77E6477F26B8E0F3CAD451C646C4083BA96F9E1C58C6AD77FBA3538DCE76450A89376221341B41BD551F40DEEC54796507F1EEF0FB5337C56D68F6C73472E11C30E1ECBA", 16)

	got := mulP(one, mulP(two, three))
	wanted := schema.MakeBigIntFromString("44B0D45583FFF3793E1300242082022E9B3F2ED8E9B6022803E3190EE7EF2E9AC1B819F1869EF08F76073752C28D92842269FC16FFE2F16191A4D387DA47296595BABB4509E3FCD3F868EF5D7D5825D039A8CAFED4A0CC7619258AA51E13FA121291B3893339B10CC066535CEF06E6FDB45BE0B1313889F9C3BB7023DC4A8726B4193E2103503F886409F76F6827F2A394729F7CF8E5BDA3F723D5445FCEFE6B5CBBB2E74F647641053FAFF8BB1AC4B19DCF7F7E15CB8E1B8F0062A3414122623AB21D618254BA29BCF0BF0C1858D638600366B7258806E411F03804D08E9A235A09F09DE1792E91503D973DE1F5E7F046345A1E6CED33DBFDB17B3FA1F7A6815D9DD7182CE4BE00DBD0353E25D45128145A641C972F61E9EFC3F1B5E648D9BCDE5FE6661BD87411E63790C6C464DCB091CBC4F1659DF9F254399731318E6340A254B54F82879A7F710273C1E8B77A5C610FC931019A72B42C467F03C95BC5061AC7D10B8AAB5B44D61E1F28D8B810BB7B53EEBE46108239FDF279BD9D849252C80B4808C9330E3276264B5CCAE4A4D643ECCAEEEDB7644F95E63000D3FAB3D8FB312D06B595181CD454CA9FC046EEDBC628B03B3DD61883DEFD6E630DC44EF8C44A80CF92552923D695EEB34E0441927B6397E9DB57C99A7D2E53ADB2953AB3644FC094CA6CB6658D76EDBF58490C5836B2C89D1184D00AFB232735FCBC1A28", 16)

	gotIsDifferentFromWanted := !got.Compare(wanted)
	if gotIsDifferentFromWanted {
		t.Error("Got:" + got.Text(16) + "\nWanted: " + wanted.Text(16))
	}
}
